[2025-05-11 08:57:06,868][__main__][INFO] - Using device: cuda
[2025-05-11 08:57:30,503][utils][INFO] - Created training dataset / Clean files: 180 / Total patches: 33456
[2025-05-11 08:57:38,207][utils][INFO] - Created validation dataset / Clean files: 60 / Total patches: 11028
[2025-05-11 08:57:38,209][model][INFO] - Model config: layers=17, channels=64, activation=relu, dilations: [1]
[2025-05-11 08:57:38,219][__main__][INFO] - Trainable parameters: 556,097
[2025-05-11 08:57:41,267][__main__][INFO] - Using SGD optimizer with initial LR: 0.075
[2025-05-11 08:57:41,271][__main__][INFO] - Starting training for up to 50 epochs on cuda
[2025-05-11 08:57:41,272][__main__][INFO] -  - Train batches/epoch: 261
[2025-05-11 08:57:41,272][__main__][INFO] -  - Val patch batches/epoch: 87
[2025-05-11 08:57:41,272][__main__][INFO] - Early stopping: Disabled
[2025-05-11 08:57:41,273][utils][INFO] - Creating validation metrics AudioMetricDataset from /scratch/lustre/home/maba8006/Tiny-SDnCNN/data/valid...
[2025-05-11 08:57:41,288][utils][INFO] - Finished creating validation metrics dataset.
[2025-05-11 08:57:41,288][utils][INFO] - Found 720 clean/noisy pairs.
[2025-05-11 08:57:41,289][__main__][INFO] - Validation metrics will be evaluated every 50 epochs on 720 files.
[2025-05-11 08:59:21,621][__main__][INFO] - Epoch 1/50 | LR: 7.50e-02 | Tr Loss: 0.0213 | Vl Loss(p): 0.0084 | Time: 100.3s
[2025-05-11 08:59:21,647][__main__][INFO] - Metric val_loss improved (0.0084 --> 0.0084). Saved best model.
[2025-05-11 09:01:01,427][__main__][INFO] - Epoch 2/50 | LR: 6.55e-02 | Tr Loss: 0.0078 | Vl Loss(p): 0.0074 | Time: 99.8s
[2025-05-11 09:01:01,444][__main__][INFO] - Metric val_loss improved (0.0074 --> 0.0074). Saved best model.
[2025-05-11 09:02:41,120][__main__][INFO] - Epoch 3/50 | LR: 5.72e-02 | Tr Loss: 0.0073 | Vl Loss(p): 0.0072 | Time: 99.7s
[2025-05-11 09:02:41,137][__main__][INFO] - Metric val_loss improved (0.0072 --> 0.0072). Saved best model.
[2025-05-11 09:04:20,884][__main__][INFO] - Epoch 4/50 | LR: 5.00e-02 | Tr Loss: 0.0070 | Vl Loss(p): 0.0071 | Time: 99.7s
[2025-05-11 09:06:00,819][__main__][INFO] - Epoch 5/50 | LR: 4.37e-02 | Tr Loss: 0.0068 | Vl Loss(p): 0.0067 | Time: 99.9s
[2025-05-11 09:06:00,836][__main__][INFO] - Metric val_loss improved (0.0067 --> 0.0067). Saved best model.
[2025-05-11 09:07:40,637][__main__][INFO] - Epoch 6/50 | LR: 3.82e-02 | Tr Loss: 0.0067 | Vl Loss(p): 0.0071 | Time: 99.8s
[2025-05-11 09:09:20,482][__main__][INFO] - Epoch 7/50 | LR: 3.33e-02 | Tr Loss: 0.0066 | Vl Loss(p): 0.0065 | Time: 99.8s
[2025-05-11 09:09:20,503][__main__][INFO] - Metric val_loss improved (0.0065 --> 0.0065). Saved best model.
[2025-05-11 09:11:00,410][__main__][INFO] - Epoch 8/50 | LR: 2.91e-02 | Tr Loss: 0.0065 | Vl Loss(p): 0.0065 | Time: 99.9s
[2025-05-11 09:12:40,224][__main__][INFO] - Epoch 9/50 | LR: 2.54e-02 | Tr Loss: 0.0064 | Vl Loss(p): 0.0067 | Time: 99.8s
[2025-05-11 09:14:20,182][__main__][INFO] - Epoch 10/50 | LR: 2.22e-02 | Tr Loss: 0.0064 | Vl Loss(p): 0.0068 | Time: 100.0s
[2025-05-11 09:15:59,904][__main__][INFO] - Epoch 11/50 | LR: 1.94e-02 | Tr Loss: 0.0063 | Vl Loss(p): 0.0064 | Time: 99.7s
[2025-05-11 09:15:59,923][__main__][INFO] - Metric val_loss improved (0.0064 --> 0.0064). Saved best model.
[2025-05-11 09:17:39,658][__main__][INFO] - Epoch 12/50 | LR: 1.70e-02 | Tr Loss: 0.0063 | Vl Loss(p): 0.0063 | Time: 99.7s
[2025-05-11 09:19:19,605][__main__][INFO] - Epoch 13/50 | LR: 1.48e-02 | Tr Loss: 0.0063 | Vl Loss(p): 0.0063 | Time: 99.9s
[2025-05-11 09:19:19,622][__main__][INFO] - Metric val_loss improved (0.0063 --> 0.0063). Saved best model.
[2025-05-11 09:20:59,521][__main__][INFO] - Epoch 14/50 | LR: 1.30e-02 | Tr Loss: 0.0062 | Vl Loss(p): 0.0063 | Time: 99.9s
[2025-05-11 09:22:39,392][__main__][INFO] - Epoch 15/50 | LR: 1.13e-02 | Tr Loss: 0.0062 | Vl Loss(p): 0.0062 | Time: 99.9s
[2025-05-11 09:24:19,239][__main__][INFO] - Epoch 16/50 | LR: 9.88e-03 | Tr Loss: 0.0062 | Vl Loss(p): 0.0062 | Time: 99.8s
[2025-05-11 09:25:59,112][__main__][INFO] - Epoch 17/50 | LR: 8.64e-03 | Tr Loss: 0.0062 | Vl Loss(p): 0.0062 | Time: 99.9s
[2025-05-11 09:27:39,081][__main__][INFO] - Epoch 18/50 | LR: 7.54e-03 | Tr Loss: 0.0062 | Vl Loss(p): 0.0062 | Time: 99.9s
[2025-05-11 09:29:18,970][__main__][INFO] - Epoch 19/50 | LR: 6.59e-03 | Tr Loss: 0.0062 | Vl Loss(p): 0.0062 | Time: 99.9s
[2025-05-11 09:30:58,747][__main__][INFO] - Epoch 20/50 | LR: 5.76e-03 | Tr Loss: 0.0061 | Vl Loss(p): 0.0062 | Time: 99.8s
[2025-05-11 09:32:38,480][__main__][INFO] - Epoch 21/50 | LR: 5.03e-03 | Tr Loss: 0.0061 | Vl Loss(p): 0.0062 | Time: 99.7s
[2025-05-11 09:34:18,229][__main__][INFO] - Epoch 22/50 | LR: 4.39e-03 | Tr Loss: 0.0061 | Vl Loss(p): 0.0061 | Time: 99.7s
[2025-05-11 09:34:18,247][__main__][INFO] - Metric val_loss improved (0.0061 --> 0.0061). Saved best model.
[2025-05-11 09:35:58,126][__main__][INFO] - Epoch 23/50 | LR: 3.84e-03 | Tr Loss: 0.0061 | Vl Loss(p): 0.0061 | Time: 99.9s
[2025-05-11 09:37:37,940][__main__][INFO] - Epoch 24/50 | LR: 3.35e-03 | Tr Loss: 0.0061 | Vl Loss(p): 0.0061 | Time: 99.8s
[2025-05-11 09:39:17,695][__main__][INFO] - Epoch 25/50 | LR: 2.93e-03 | Tr Loss: 0.0061 | Vl Loss(p): 0.0062 | Time: 99.8s
[2025-05-11 09:40:57,480][__main__][INFO] - Epoch 26/50 | LR: 2.56e-03 | Tr Loss: 0.0061 | Vl Loss(p): 0.0061 | Time: 99.8s
[2025-05-11 09:42:37,255][__main__][INFO] - Epoch 27/50 | LR: 2.24e-03 | Tr Loss: 0.0061 | Vl Loss(p): 0.0061 | Time: 99.8s
[2025-05-11 09:44:17,167][__main__][INFO] - Epoch 28/50 | LR: 1.95e-03 | Tr Loss: 0.0061 | Vl Loss(p): 0.0061 | Time: 99.9s
[2025-05-11 09:45:56,929][__main__][INFO] - Epoch 29/50 | LR: 1.71e-03 | Tr Loss: 0.0061 | Vl Loss(p): 0.0061 | Time: 99.8s
[2025-05-11 09:47:36,747][__main__][INFO] - Epoch 30/50 | LR: 1.49e-03 | Tr Loss: 0.0061 | Vl Loss(p): 0.0061 | Time: 99.8s
[2025-05-11 09:49:16,636][__main__][INFO] - Epoch 31/50 | LR: 1.30e-03 | Tr Loss: 0.0061 | Vl Loss(p): 0.0061 | Time: 99.9s
[2025-05-11 09:50:56,643][__main__][INFO] - Epoch 32/50 | LR: 1.14e-03 | Tr Loss: 0.0061 | Vl Loss(p): 0.0061 | Time: 100.0s
[2025-05-11 09:52:36,660][__main__][INFO] - Epoch 33/50 | LR: 9.94e-04 | Tr Loss: 0.0061 | Vl Loss(p): 0.0061 | Time: 100.0s
[2025-05-11 09:54:16,551][__main__][INFO] - Epoch 34/50 | LR: 8.69e-04 | Tr Loss: 0.0061 | Vl Loss(p): 0.0061 | Time: 99.9s
[2025-05-11 09:55:56,341][__main__][INFO] - Epoch 35/50 | LR: 7.59e-04 | Tr Loss: 0.0061 | Vl Loss(p): 0.0061 | Time: 99.8s
[2025-05-11 09:57:36,305][__main__][INFO] - Epoch 36/50 | LR: 6.63e-04 | Tr Loss: 0.0061 | Vl Loss(p): 0.0061 | Time: 100.0s
[2025-05-11 09:59:16,097][__main__][INFO] - Epoch 37/50 | LR: 5.79e-04 | Tr Loss: 0.0061 | Vl Loss(p): 0.0061 | Time: 99.8s
[2025-05-11 10:00:55,891][__main__][INFO] - Epoch 38/50 | LR: 5.06e-04 | Tr Loss: 0.0061 | Vl Loss(p): 0.0061 | Time: 99.8s
[2025-05-11 10:02:35,967][__main__][INFO] - Epoch 39/50 | LR: 4.42e-04 | Tr Loss: 0.0061 | Vl Loss(p): 0.0061 | Time: 100.1s
[2025-05-11 10:04:15,980][__main__][INFO] - Epoch 40/50 | LR: 3.86e-04 | Tr Loss: 0.0060 | Vl Loss(p): 0.0061 | Time: 100.0s
[2025-05-11 10:05:55,792][__main__][INFO] - Epoch 41/50 | LR: 3.37e-04 | Tr Loss: 0.0061 | Vl Loss(p): 0.0061 | Time: 99.8s
[2025-05-11 10:07:35,607][__main__][INFO] - Epoch 42/50 | LR: 2.95e-04 | Tr Loss: 0.0061 | Vl Loss(p): 0.0061 | Time: 99.8s
[2025-05-11 10:09:15,555][__main__][INFO] - Epoch 43/50 | LR: 2.57e-04 | Tr Loss: 0.0060 | Vl Loss(p): 0.0061 | Time: 99.9s
[2025-05-11 10:10:55,484][__main__][INFO] - Epoch 44/50 | LR: 2.25e-04 | Tr Loss: 0.0061 | Vl Loss(p): 0.0061 | Time: 99.9s
[2025-05-11 10:12:35,411][__main__][INFO] - Epoch 45/50 | LR: 1.97e-04 | Tr Loss: 0.0060 | Vl Loss(p): 0.0061 | Time: 99.9s
[2025-05-11 10:14:15,273][__main__][INFO] - Epoch 46/50 | LR: 1.72e-04 | Tr Loss: 0.0061 | Vl Loss(p): 0.0061 | Time: 99.9s
[2025-05-11 10:15:55,115][__main__][INFO] - Epoch 47/50 | LR: 1.50e-04 | Tr Loss: 0.0061 | Vl Loss(p): 0.0061 | Time: 99.8s
[2025-05-11 10:17:35,030][__main__][INFO] - Epoch 48/50 | LR: 1.31e-04 | Tr Loss: 0.0060 | Vl Loss(p): 0.0061 | Time: 99.9s
[2025-05-11 10:19:14,902][__main__][INFO] - Epoch 49/50 | LR: 1.14e-04 | Tr Loss: 0.0060 | Vl Loss(p): 0.0061 | Time: 99.9s
[2025-05-11 10:20:54,890][__main__][INFO] - Epoch 50: Evaluating metrics on validation set...
[2025-05-11 10:22:34,949][__main__][INFO] - Epoch 50: Val Metrics | PESQ: 2.282 | STOI: 0.889 | SI-SDR: 16.070 | Eval Time: 100.1s
[2025-05-11 10:22:34,950][__main__][INFO] - Epoch 50/50 | LR: 1.00e-04 | Tr Loss: 0.0060 | Vl Loss(p): 0.0061 | Time: 200.0s
[2025-05-11 10:22:34,954][__main__][INFO] - ==============================
[2025-05-11 10:22:34,954][__main__][INFO] - Training finished.
[2025-05-11 10:22:34,954][__main__][INFO] - Completed 50 epochs. Best val_loss: 0.0061 achieved at epoch 22.
[2025-05-11 10:22:34,957][__main__][INFO] - Best model weights saved to: /scratch/lustre/home/maba8006/Tiny-SDnCNN/outputs/2025-05-11_08-57-06/best_model.pt
[2025-05-11 10:22:34,957][__main__][INFO] - ==============================
