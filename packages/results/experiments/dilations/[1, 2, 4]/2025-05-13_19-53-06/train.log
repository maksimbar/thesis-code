[2025-05-13 19:53:06,777][__main__][INFO] - Using device: cuda
[2025-05-13 19:53:24,830][utils][INFO] - Created training dataset / Clean files: 180 / Total patches: 33456
[2025-05-13 19:53:30,704][utils][INFO] - Created validation dataset / Clean files: 60 / Total patches: 11028
[2025-05-13 19:53:30,705][model][INFO] - Model config: layers=17, channels=64, activation=relu, dilations: [1, 2, 4]
[2025-05-13 19:53:30,714][__main__][INFO] - Trainable parameters: 556,097
[2025-05-13 19:53:33,299][__main__][INFO] - Using SGD optimizer with initial LR: 0.075
[2025-05-13 19:53:33,304][__main__][INFO] - Starting training for up to 50 epochs on cuda
[2025-05-13 19:53:33,304][__main__][INFO] -  - Train batches/epoch: 261
[2025-05-13 19:53:33,304][__main__][INFO] -  - Val patch batches/epoch: 87
[2025-05-13 19:53:33,304][__main__][INFO] - Early stopping: Enabled
[2025-05-13 19:53:33,304][__main__][INFO] -  - Patience: 5, Min Delta: 1e-05
[2025-05-13 19:53:33,305][utils][INFO] - Creating validation metrics AudioMetricDataset from /scratch/lustre/home/maba8006/Tiny-SDnCNN/data/valid...
[2025-05-13 19:53:33,317][utils][INFO] - Finished creating validation metrics dataset.
[2025-05-13 19:53:33,317][utils][INFO] - Found 720 clean/noisy pairs.
[2025-05-13 19:53:33,318][__main__][INFO] - Validation metrics will be evaluated every 1 epochs on 720 files.
[2025-05-13 19:55:22,592][__main__][INFO] - Epoch 1: Evaluating metrics on validation set...
[2025-05-13 19:56:29,649][__main__][INFO] - Epoch 1: Val Metrics | PESQ: 2.054 | STOI: nan | SI-SDR: nan | Eval Time: 67.1s
[2025-05-13 19:56:29,650][__main__][INFO] - Epoch 1/50 | LR: 7.50e-02 | Tr Loss: 0.0236 | Vl Loss(p): 0.0079 | Time: 176.3s
[2025-05-13 19:56:29,672][__main__][INFO] - Metric val_loss improved (0.0079 --> 0.0079). Saved best model.
[2025-05-13 19:58:15,403][__main__][INFO] - Epoch 2: Evaluating metrics on validation set...
[2025-05-13 19:59:21,383][__main__][INFO] - Epoch 2: Val Metrics | PESQ: 2.156 | STOI: nan | SI-SDR: nan | Eval Time: 66.0s
[2025-05-13 19:59:21,383][__main__][INFO] - Epoch 2/50 | LR: 6.55e-02 | Tr Loss: 0.0077 | Vl Loss(p): 0.0078 | Time: 171.7s
[2025-05-13 19:59:21,399][__main__][INFO] - Metric val_loss improved (0.0078 --> 0.0078). Saved best model.
[2025-05-13 20:01:07,484][__main__][INFO] - Epoch 3: Evaluating metrics on validation set...
[2025-05-13 20:02:13,191][__main__][INFO] - Epoch 3: Val Metrics | PESQ: 2.225 | STOI: nan | SI-SDR: nan | Eval Time: 65.7s
[2025-05-13 20:02:13,191][__main__][INFO] - Epoch 3/50 | LR: 5.72e-02 | Tr Loss: 0.0073 | Vl Loss(p): 0.0074 | Time: 171.8s
[2025-05-13 20:02:13,206][__main__][INFO] - Metric val_loss improved (0.0074 --> 0.0074). Saved best model.
[2025-05-13 20:03:59,263][__main__][INFO] - Epoch 4: Evaluating metrics on validation set...
[2025-05-13 20:05:05,535][__main__][INFO] - Epoch 4: Val Metrics | PESQ: 2.257 | STOI: nan | SI-SDR: nan | Eval Time: 66.3s
[2025-05-13 20:05:05,535][__main__][INFO] - Epoch 4/50 | LR: 5.00e-02 | Tr Loss: 0.0070 | Vl Loss(p): 0.0081 | Time: 172.3s
[2025-05-13 20:06:52,033][__main__][INFO] - Epoch 5: Evaluating metrics on validation set...
[2025-05-13 20:08:00,257][__main__][INFO] - Epoch 5: Val Metrics | PESQ: 2.323 | STOI: nan | SI-SDR: nan | Eval Time: 68.2s
[2025-05-13 20:08:00,257][__main__][INFO] - Epoch 5/50 | LR: 4.37e-02 | Tr Loss: 0.0069 | Vl Loss(p): 0.0071 | Time: 174.7s
[2025-05-13 20:08:00,276][__main__][INFO] - Metric val_loss improved (0.0071 --> 0.0071). Saved best model.
[2025-05-13 20:09:46,365][__main__][INFO] - Epoch 6: Evaluating metrics on validation set...
[2025-05-13 20:10:51,603][__main__][INFO] - Epoch 6: Val Metrics | PESQ: 2.256 | STOI: nan | SI-SDR: nan | Eval Time: 65.2s
[2025-05-13 20:10:51,603][__main__][INFO] - Epoch 6/50 | LR: 3.82e-02 | Tr Loss: 0.0068 | Vl Loss(p): 0.0070 | Time: 171.3s
[2025-05-13 20:10:51,617][__main__][INFO] - Metric val_loss improved (0.0070 --> 0.0070). Saved best model.
[2025-05-13 20:12:37,392][__main__][INFO] - Epoch 7: Evaluating metrics on validation set...
[2025-05-13 20:13:42,375][__main__][INFO] - Epoch 7: Val Metrics | PESQ: 2.343 | STOI: nan | SI-SDR: nan | Eval Time: 65.0s
[2025-05-13 20:13:42,375][__main__][INFO] - Epoch 7/50 | LR: 3.33e-02 | Tr Loss: 0.0067 | Vl Loss(p): 0.0070 | Time: 170.8s
[2025-05-13 20:13:42,391][__main__][INFO] - Metric val_loss improved (0.0070 --> 0.0070). Saved best model.
[2025-05-13 20:15:28,277][__main__][INFO] - Epoch 8: Evaluating metrics on validation set...
[2025-05-13 20:16:33,857][__main__][INFO] - Epoch 8: Val Metrics | PESQ: 2.279 | STOI: nan | SI-SDR: nan | Eval Time: 65.6s
[2025-05-13 20:16:33,857][__main__][INFO] - Epoch 8/50 | LR: 2.91e-02 | Tr Loss: 0.0066 | Vl Loss(p): 0.0070 | Time: 171.5s
[2025-05-13 20:18:19,822][__main__][INFO] - Epoch 9: Evaluating metrics on validation set...
[2025-05-13 20:19:25,462][__main__][INFO] - Epoch 9: Val Metrics | PESQ: 2.289 | STOI: nan | SI-SDR: nan | Eval Time: 65.6s
[2025-05-13 20:19:25,462][__main__][INFO] - Epoch 9/50 | LR: 2.54e-02 | Tr Loss: 0.0066 | Vl Loss(p): 0.0072 | Time: 171.6s
[2025-05-13 20:21:11,418][__main__][INFO] - Epoch 10: Evaluating metrics on validation set...
[2025-05-13 20:22:16,537][__main__][INFO] - Epoch 10: Val Metrics | PESQ: 2.346 | STOI: nan | SI-SDR: nan | Eval Time: 65.1s
[2025-05-13 20:22:16,537][__main__][INFO] - Epoch 10/50 | LR: 2.22e-02 | Tr Loss: 0.0065 | Vl Loss(p): 0.0067 | Time: 171.1s
[2025-05-13 20:22:16,551][__main__][INFO] - Metric val_loss improved (0.0067 --> 0.0067). Saved best model.
[2025-05-13 20:24:02,552][__main__][INFO] - Epoch 11: Evaluating metrics on validation set...
[2025-05-13 20:25:11,647][__main__][INFO] - Epoch 11: Val Metrics | PESQ: 2.374 | STOI: nan | SI-SDR: nan | Eval Time: 69.1s
[2025-05-13 20:25:11,647][__main__][INFO] - Epoch 11/50 | LR: 1.94e-02 | Tr Loss: 0.0065 | Vl Loss(p): 0.0066 | Time: 175.1s
[2025-05-13 20:26:58,099][__main__][INFO] - Epoch 12: Evaluating metrics on validation set...
[2025-05-13 20:28:02,795][__main__][INFO] - Epoch 12: Val Metrics | PESQ: 2.352 | STOI: nan | SI-SDR: nan | Eval Time: 64.7s
[2025-05-13 20:28:02,795][__main__][INFO] - Epoch 12/50 | LR: 1.70e-02 | Tr Loss: 0.0064 | Vl Loss(p): 0.0066 | Time: 171.1s
[2025-05-13 20:28:02,810][__main__][INFO] - Metric val_loss improved (0.0066 --> 0.0066). Saved best model.
[2025-05-13 20:29:48,792][__main__][INFO] - Epoch 13: Evaluating metrics on validation set...
[2025-05-13 20:30:53,578][__main__][INFO] - Epoch 13: Val Metrics | PESQ: 2.365 | STOI: nan | SI-SDR: nan | Eval Time: 64.8s
[2025-05-13 20:30:53,578][__main__][INFO] - Epoch 13/50 | LR: 1.48e-02 | Tr Loss: 0.0064 | Vl Loss(p): 0.0069 | Time: 170.8s
[2025-05-13 20:32:39,628][__main__][INFO] - Epoch 14: Evaluating metrics on validation set...
[2025-05-13 20:33:44,510][__main__][INFO] - Epoch 14: Val Metrics | PESQ: 2.363 | STOI: nan | SI-SDR: nan | Eval Time: 64.9s
[2025-05-13 20:33:44,511][__main__][INFO] - Epoch 14/50 | LR: 1.30e-02 | Tr Loss: 0.0064 | Vl Loss(p): 0.0065 | Time: 170.9s
[2025-05-13 20:33:44,526][__main__][INFO] - Metric val_loss improved (0.0065 --> 0.0065). Saved best model.
[2025-05-13 20:35:30,432][__main__][INFO] - Epoch 15: Evaluating metrics on validation set...
[2025-05-13 20:36:35,391][__main__][INFO] - Epoch 15: Val Metrics | PESQ: 2.359 | STOI: nan | SI-SDR: nan | Eval Time: 65.0s
[2025-05-13 20:36:35,392][__main__][INFO] - Epoch 15/50 | LR: 1.13e-02 | Tr Loss: 0.0063 | Vl Loss(p): 0.0065 | Time: 170.9s
[2025-05-13 20:36:35,407][__main__][INFO] - Metric val_loss improved (0.0065 --> 0.0065). Saved best model.
[2025-05-13 20:38:21,388][__main__][INFO] - Epoch 16: Evaluating metrics on validation set...
[2025-05-13 20:39:26,335][__main__][INFO] - Epoch 16: Val Metrics | PESQ: 2.370 | STOI: nan | SI-SDR: nan | Eval Time: 64.9s
[2025-05-13 20:39:26,336][__main__][INFO] - Epoch 16/50 | LR: 9.88e-03 | Tr Loss: 0.0063 | Vl Loss(p): 0.0065 | Time: 170.9s
[2025-05-13 20:41:12,107][__main__][INFO] - Epoch 17: Evaluating metrics on validation set...
[2025-05-13 20:42:16,544][__main__][INFO] - Epoch 17: Val Metrics | PESQ: 2.354 | STOI: nan | SI-SDR: nan | Eval Time: 64.4s
[2025-05-13 20:42:16,544][__main__][INFO] - Epoch 17/50 | LR: 8.64e-03 | Tr Loss: 0.0063 | Vl Loss(p): 0.0067 | Time: 170.2s
[2025-05-13 20:44:02,658][__main__][INFO] - Epoch 18: Evaluating metrics on validation set...
[2025-05-13 20:45:07,798][__main__][INFO] - Epoch 18: Val Metrics | PESQ: 2.353 | STOI: nan | SI-SDR: nan | Eval Time: 65.1s
[2025-05-13 20:45:07,798][__main__][INFO] - Epoch 18/50 | LR: 7.54e-03 | Tr Loss: 0.0063 | Vl Loss(p): 0.0066 | Time: 171.3s
[2025-05-13 20:46:53,893][__main__][INFO] - Epoch 19: Evaluating metrics on validation set...
[2025-05-13 20:47:58,762][__main__][INFO] - Epoch 19: Val Metrics | PESQ: 2.353 | STOI: nan | SI-SDR: nan | Eval Time: 64.9s
[2025-05-13 20:47:58,764][__main__][INFO] - Epoch 19/50 | LR: 6.59e-03 | Tr Loss: 0.0063 | Vl Loss(p): 0.0065 | Time: 171.0s
[2025-05-13 20:47:58,779][__main__][INFO] - Metric val_loss improved (0.0065 --> 0.0065). Saved best model.
[2025-05-13 20:49:44,705][__main__][INFO] - Epoch 20: Evaluating metrics on validation set...
[2025-05-13 20:50:49,538][__main__][INFO] - Epoch 20: Val Metrics | PESQ: 2.368 | STOI: nan | SI-SDR: nan | Eval Time: 64.8s
[2025-05-13 20:50:49,539][__main__][INFO] - Epoch 20/50 | LR: 5.76e-03 | Tr Loss: 0.0062 | Vl Loss(p): 0.0065 | Time: 170.8s
[2025-05-13 20:52:35,491][__main__][INFO] - Epoch 21: Evaluating metrics on validation set...
[2025-05-13 20:53:40,424][__main__][INFO] - Epoch 21: Val Metrics | PESQ: 2.365 | STOI: nan | SI-SDR: nan | Eval Time: 64.9s
[2025-05-13 20:53:40,424][__main__][INFO] - Epoch 21/50 | LR: 5.03e-03 | Tr Loss: 0.0062 | Vl Loss(p): 0.0065 | Time: 170.9s
[2025-05-13 20:53:40,439][__main__][INFO] - Metric val_loss improved (0.0065 --> 0.0065). Saved best model.
[2025-05-13 20:55:26,452][__main__][INFO] - Epoch 22: Evaluating metrics on validation set...
[2025-05-13 20:56:31,402][__main__][INFO] - Epoch 22: Val Metrics | PESQ: 2.370 | STOI: nan | SI-SDR: nan | Eval Time: 64.9s
[2025-05-13 20:56:31,402][__main__][INFO] - Epoch 22/50 | LR: 4.39e-03 | Tr Loss: 0.0062 | Vl Loss(p): 0.0064 | Time: 171.0s
[2025-05-13 20:56:31,417][__main__][INFO] - Metric val_loss improved (0.0064 --> 0.0064). Saved best model.
[2025-05-13 20:58:17,643][__main__][INFO] - Epoch 23: Evaluating metrics on validation set...
[2025-05-13 20:59:22,219][__main__][INFO] - Epoch 23: Val Metrics | PESQ: 2.379 | STOI: nan | SI-SDR: nan | Eval Time: 64.6s
[2025-05-13 20:59:22,219][__main__][INFO] - Epoch 23/50 | LR: 3.84e-03 | Tr Loss: 0.0062 | Vl Loss(p): 0.0064 | Time: 170.8s
[2025-05-13 21:01:08,239][__main__][INFO] - Epoch 24: Evaluating metrics on validation set...
[2025-05-13 21:02:12,593][__main__][INFO] - Epoch 24: Val Metrics | PESQ: 2.349 | STOI: nan | SI-SDR: nan | Eval Time: 64.4s
[2025-05-13 21:02:12,593][__main__][INFO] - Epoch 24/50 | LR: 3.35e-03 | Tr Loss: 0.0062 | Vl Loss(p): 0.0066 | Time: 170.4s
[2025-05-13 21:03:58,573][__main__][INFO] - Epoch 25: Evaluating metrics on validation set...
[2025-05-13 21:05:03,409][__main__][INFO] - Epoch 25: Val Metrics | PESQ: 2.369 | STOI: nan | SI-SDR: nan | Eval Time: 64.8s
[2025-05-13 21:05:03,409][__main__][INFO] - Epoch 25/50 | LR: 2.93e-03 | Tr Loss: 0.0062 | Vl Loss(p): 0.0065 | Time: 170.8s
[2025-05-13 21:06:49,395][__main__][INFO] - Epoch 26: Evaluating metrics on validation set...
[2025-05-13 21:07:54,262][__main__][INFO] - Epoch 26: Val Metrics | PESQ: 2.389 | STOI: nan | SI-SDR: nan | Eval Time: 64.9s
[2025-05-13 21:07:54,262][__main__][INFO] - Epoch 26/50 | LR: 2.56e-03 | Tr Loss: 0.0062 | Vl Loss(p): 0.0064 | Time: 170.9s
[2025-05-13 21:07:54,291][__main__][INFO] - Metric val_loss improved (0.0064 --> 0.0064). Saved best model.
[2025-05-13 21:09:40,290][__main__][INFO] - Epoch 27: Evaluating metrics on validation set...
[2025-05-13 21:10:44,528][__main__][INFO] - Epoch 27: Val Metrics | PESQ: 2.378 | STOI: nan | SI-SDR: nan | Eval Time: 64.2s
[2025-05-13 21:10:44,529][__main__][INFO] - Epoch 27/50 | LR: 2.24e-03 | Tr Loss: 0.0062 | Vl Loss(p): 0.0064 | Time: 170.2s
[2025-05-13 21:12:30,665][__main__][INFO] - Epoch 28: Evaluating metrics on validation set...
[2025-05-13 21:13:35,118][__main__][INFO] - Epoch 28: Val Metrics | PESQ: 2.364 | STOI: nan | SI-SDR: nan | Eval Time: 64.5s
[2025-05-13 21:13:35,118][__main__][INFO] - Epoch 28/50 | LR: 1.95e-03 | Tr Loss: 0.0062 | Vl Loss(p): 0.0064 | Time: 170.6s
[2025-05-13 21:15:21,119][__main__][INFO] - Epoch 29: Evaluating metrics on validation set...
[2025-05-13 21:16:32,043][__main__][INFO] - Epoch 29: Val Metrics | PESQ: 2.383 | STOI: nan | SI-SDR: nan | Eval Time: 70.9s
[2025-05-13 21:16:32,043][__main__][INFO] - Epoch 29/50 | LR: 1.71e-03 | Tr Loss: 0.0062 | Vl Loss(p): 0.0064 | Time: 176.9s
[2025-05-13 21:18:18,171][__main__][INFO] - Epoch 30: Evaluating metrics on validation set...
[2025-05-13 21:19:22,851][__main__][INFO] - Epoch 30: Val Metrics | PESQ: 2.383 | STOI: nan | SI-SDR: nan | Eval Time: 64.7s
[2025-05-13 21:19:22,851][__main__][INFO] - Epoch 30/50 | LR: 1.49e-03 | Tr Loss: 0.0062 | Vl Loss(p): 0.0064 | Time: 170.8s
[2025-05-13 21:21:09,027][__main__][INFO] - Epoch 31: Evaluating metrics on validation set...
[2025-05-13 21:22:13,851][__main__][INFO] - Epoch 31: Val Metrics | PESQ: 2.381 | STOI: nan | SI-SDR: nan | Eval Time: 64.8s
[2025-05-13 21:22:13,851][__main__][INFO] - Epoch 31/50 | LR: 1.30e-03 | Tr Loss: 0.0062 | Vl Loss(p): 0.0064 | Time: 171.0s
[2025-05-13 21:22:13,853][__main__][INFO] - --- Early stopping triggered at epoch 31 ---
[2025-05-13 21:22:13,853][__main__][INFO] - ==============================
[2025-05-13 21:22:13,853][__main__][INFO] - Training finished.
[2025-05-13 21:22:13,853][__main__][INFO] - Stopped early at epoch 31. Best val_loss: 0.0064 achieved at epoch 26.
[2025-05-13 21:22:13,856][__main__][INFO] - Best model weights saved to: /scratch/lustre/home/maba8006/Tiny-SDnCNN/outputs/2025-05-13_19-53-06/best_model.pt
[2025-05-13 21:22:13,857][__main__][INFO] - ==============================
