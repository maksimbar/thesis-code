[2025-05-11 13:09:45,216][__main__][INFO] - Using device: cuda
[2025-05-11 13:10:14,507][utils][INFO] - Created training dataset / Clean files: 180 / Total patches: 33456
[2025-05-11 13:10:22,356][utils][INFO] - Created validation dataset / Clean files: 60 / Total patches: 11028
[2025-05-11 13:10:22,358][model][INFO] - Model config: layers=17, channels=64, activation=relu, dilations: [1]
[2025-05-11 13:10:22,375][__main__][INFO] - Trainable parameters: 556,097
[2025-05-11 13:10:28,839][__main__][INFO] - Using SGD optimizer with initial LR: 0.075
[2025-05-11 13:10:28,843][__main__][INFO] - Starting training for up to 50 epochs on cuda
[2025-05-11 13:10:28,843][__main__][INFO] -  - Train batches/epoch: 261
[2025-05-11 13:10:28,844][__main__][INFO] -  - Val patch batches/epoch: 87
[2025-05-11 13:10:28,844][__main__][INFO] - Early stopping: Enabled
[2025-05-11 13:10:28,844][__main__][INFO] -  - Patience: 5, Min Delta: 1e-05
[2025-05-11 13:10:28,846][utils][INFO] - Creating validation metrics AudioMetricDataset from /scratch/lustre/home/maba8006/Tiny-SDnCNN/data/valid...
[2025-05-11 13:10:28,861][utils][INFO] - Finished creating validation metrics dataset.
[2025-05-11 13:10:28,861][utils][INFO] - Found 720 clean/noisy pairs.
[2025-05-11 13:10:28,862][__main__][INFO] - Validation metrics will be evaluated every 1 epochs on 720 files.
[2025-05-11 13:12:09,513][__main__][INFO] - Epoch 1: Evaluating metrics on validation set...
[2025-05-11 13:13:16,209][__main__][INFO] - Epoch 1: Val Metrics | PESQ: 2.088 | STOI: nan | SI-SDR: nan | Eval Time: 66.7s
[2025-05-11 13:13:16,210][__main__][INFO] - Epoch 1/50 | LR: 7.50e-02 | Tr Loss: 0.0213 | Vl Loss(p): 0.0084 | Time: 167.3s
[2025-05-11 13:13:16,243][__main__][INFO] - Metric val_loss improved (0.0084 --> 0.0084). Saved best model.
[2025-05-11 13:14:55,240][__main__][INFO] - Epoch 2: Evaluating metrics on validation set...
[2025-05-11 13:16:05,149][__main__][INFO] - Epoch 2: Val Metrics | PESQ: 2.012 | STOI: nan | SI-SDR: nan | Eval Time: 69.9s
[2025-05-11 13:16:05,150][__main__][INFO] - Epoch 2/50 | LR: 6.55e-02 | Tr Loss: 0.0078 | Vl Loss(p): 0.0077 | Time: 168.9s
[2025-05-11 13:16:05,164][__main__][INFO] - Metric val_loss improved (0.0077 --> 0.0077). Saved best model.
[2025-05-11 13:17:43,890][__main__][INFO] - Epoch 3: Evaluating metrics on validation set...
[2025-05-11 13:18:46,957][__main__][INFO] - Epoch 3: Val Metrics | PESQ: 2.308 | STOI: nan | SI-SDR: nan | Eval Time: 63.1s
[2025-05-11 13:18:46,957][__main__][INFO] - Epoch 3/50 | LR: 5.72e-02 | Tr Loss: 0.0073 | Vl Loss(p): 0.0076 | Time: 161.8s
[2025-05-11 13:18:46,971][__main__][INFO] - Metric val_loss improved (0.0076 --> 0.0076). Saved best model.
[2025-05-11 13:20:25,891][__main__][INFO] - Epoch 4: Evaluating metrics on validation set...
[2025-05-11 13:21:43,903][__main__][INFO] - Epoch 4: Val Metrics | PESQ: 2.270 | STOI: nan | SI-SDR: nan | Eval Time: 78.0s
[2025-05-11 13:21:43,903][__main__][INFO] - Epoch 4/50 | LR: 5.00e-02 | Tr Loss: 0.0070 | Vl Loss(p): 0.0068 | Time: 176.9s
[2025-05-11 13:21:43,920][__main__][INFO] - Metric val_loss improved (0.0068 --> 0.0068). Saved best model.
[2025-05-11 13:23:24,258][__main__][INFO] - Epoch 5: Evaluating metrics on validation set...
[2025-05-11 13:24:48,739][__main__][INFO] - Epoch 5: Val Metrics | PESQ: 2.046 | STOI: nan | SI-SDR: nan | Eval Time: 84.5s
[2025-05-11 13:24:48,740][__main__][INFO] - Epoch 5/50 | LR: 4.37e-02 | Tr Loss: 0.0068 | Vl Loss(p): 0.0077 | Time: 184.8s
[2025-05-11 13:26:29,077][__main__][INFO] - Epoch 6: Evaluating metrics on validation set...
[2025-05-11 13:27:51,971][__main__][INFO] - Epoch 6: Val Metrics | PESQ: 2.194 | STOI: nan | SI-SDR: nan | Eval Time: 82.9s
[2025-05-11 13:27:51,972][__main__][INFO] - Epoch 6/50 | LR: 3.82e-02 | Tr Loss: 0.0067 | Vl Loss(p): 0.0066 | Time: 183.2s
[2025-05-11 13:27:51,989][__main__][INFO] - Metric val_loss improved (0.0066 --> 0.0066). Saved best model.
[2025-05-11 13:29:32,299][__main__][INFO] - Epoch 7: Evaluating metrics on validation set...
[2025-05-11 13:30:55,542][__main__][INFO] - Epoch 7: Val Metrics | PESQ: 2.136 | STOI: nan | SI-SDR: nan | Eval Time: 83.2s
[2025-05-11 13:30:55,543][__main__][INFO] - Epoch 7/50 | LR: 3.33e-02 | Tr Loss: 0.0066 | Vl Loss(p): 0.0070 | Time: 183.6s
[2025-05-11 13:32:35,885][__main__][INFO] - Epoch 8: Evaluating metrics on validation set...
[2025-05-11 13:33:57,952][__main__][INFO] - Epoch 8: Val Metrics | PESQ: 2.123 | STOI: nan | SI-SDR: nan | Eval Time: 82.1s
[2025-05-11 13:33:57,953][__main__][INFO] - Epoch 8/50 | LR: 2.91e-02 | Tr Loss: 0.0065 | Vl Loss(p): 0.0067 | Time: 182.4s
[2025-05-11 13:35:38,149][__main__][INFO] - Epoch 9: Evaluating metrics on validation set...
[2025-05-11 13:36:41,734][__main__][INFO] - Epoch 9: Val Metrics | PESQ: 2.207 | STOI: nan | SI-SDR: nan | Eval Time: 63.6s
[2025-05-11 13:36:41,734][__main__][INFO] - Epoch 9/50 | LR: 2.54e-02 | Tr Loss: 0.0064 | Vl Loss(p): 0.0068 | Time: 163.8s
[2025-05-11 13:38:20,483][__main__][INFO] - Epoch 10: Evaluating metrics on validation set...
[2025-05-11 13:39:24,650][__main__][INFO] - Epoch 10: Val Metrics | PESQ: 2.191 | STOI: nan | SI-SDR: nan | Eval Time: 64.2s
[2025-05-11 13:39:24,650][__main__][INFO] - Epoch 10/50 | LR: 2.22e-02 | Tr Loss: 0.0064 | Vl Loss(p): 0.0066 | Time: 162.9s
[2025-05-11 13:41:03,307][__main__][INFO] - Epoch 11: Evaluating metrics on validation set...
[2025-05-11 13:42:07,084][__main__][INFO] - Epoch 11: Val Metrics | PESQ: 2.286 | STOI: nan | SI-SDR: nan | Eval Time: 63.8s
[2025-05-11 13:42:07,085][__main__][INFO] - Epoch 11/50 | LR: 1.94e-02 | Tr Loss: 0.0063 | Vl Loss(p): 0.0063 | Time: 162.4s
[2025-05-11 13:42:07,099][__main__][INFO] - Metric val_loss improved (0.0063 --> 0.0063). Saved best model.
[2025-05-11 13:43:45,613][__main__][INFO] - Epoch 12: Evaluating metrics on validation set...
[2025-05-11 13:44:49,505][__main__][INFO] - Epoch 12: Val Metrics | PESQ: 2.242 | STOI: nan | SI-SDR: nan | Eval Time: 63.9s
[2025-05-11 13:44:49,506][__main__][INFO] - Epoch 12/50 | LR: 1.70e-02 | Tr Loss: 0.0063 | Vl Loss(p): 0.0063 | Time: 162.4s
[2025-05-11 13:44:49,520][__main__][INFO] - Metric val_loss improved (0.0063 --> 0.0063). Saved best model.
[2025-05-11 13:46:28,107][__main__][INFO] - Epoch 13: Evaluating metrics on validation set...
[2025-05-11 13:47:31,919][__main__][INFO] - Epoch 13: Val Metrics | PESQ: 2.228 | STOI: nan | SI-SDR: nan | Eval Time: 63.8s
[2025-05-11 13:47:31,919][__main__][INFO] - Epoch 13/50 | LR: 1.48e-02 | Tr Loss: 0.0063 | Vl Loss(p): 0.0063 | Time: 162.4s
[2025-05-11 13:49:10,334][__main__][INFO] - Epoch 14: Evaluating metrics on validation set...
[2025-05-11 13:50:14,179][__main__][INFO] - Epoch 14: Val Metrics | PESQ: 2.241 | STOI: nan | SI-SDR: nan | Eval Time: 63.8s
[2025-05-11 13:50:14,180][__main__][INFO] - Epoch 14/50 | LR: 1.30e-02 | Tr Loss: 0.0062 | Vl Loss(p): 0.0062 | Time: 162.3s
[2025-05-11 13:50:14,195][__main__][INFO] - Metric val_loss improved (0.0062 --> 0.0062). Saved best model.
[2025-05-11 13:51:52,613][__main__][INFO] - Epoch 15: Evaluating metrics on validation set...
[2025-05-11 13:52:56,222][__main__][INFO] - Epoch 15: Val Metrics | PESQ: 2.261 | STOI: nan | SI-SDR: nan | Eval Time: 63.6s
[2025-05-11 13:52:56,223][__main__][INFO] - Epoch 15/50 | LR: 1.13e-02 | Tr Loss: 0.0062 | Vl Loss(p): 0.0062 | Time: 162.0s
[2025-05-11 13:52:56,238][__main__][INFO] - Metric val_loss improved (0.0062 --> 0.0062). Saved best model.
[2025-05-11 13:54:34,665][__main__][INFO] - Epoch 16: Evaluating metrics on validation set...
[2025-05-11 13:55:38,442][__main__][INFO] - Epoch 16: Val Metrics | PESQ: 2.335 | STOI: nan | SI-SDR: nan | Eval Time: 63.8s
[2025-05-11 13:55:38,442][__main__][INFO] - Epoch 16/50 | LR: 9.88e-03 | Tr Loss: 0.0062 | Vl Loss(p): 0.0062 | Time: 162.2s
[2025-05-11 13:57:18,420][__main__][INFO] - Epoch 17: Evaluating metrics on validation set...
[2025-05-11 13:58:40,579][__main__][INFO] - Epoch 17: Val Metrics | PESQ: 2.287 | STOI: nan | SI-SDR: nan | Eval Time: 82.2s
[2025-05-11 13:58:40,580][__main__][INFO] - Epoch 17/50 | LR: 8.64e-03 | Tr Loss: 0.0062 | Vl Loss(p): 0.0062 | Time: 182.1s
[2025-05-11 14:00:20,625][__main__][INFO] - Epoch 18: Evaluating metrics on validation set...
[2025-05-11 14:01:41,806][__main__][INFO] - Epoch 18: Val Metrics | PESQ: 2.232 | STOI: nan | SI-SDR: nan | Eval Time: 81.2s
[2025-05-11 14:01:41,807][__main__][INFO] - Epoch 18/50 | LR: 7.54e-03 | Tr Loss: 0.0062 | Vl Loss(p): 0.0063 | Time: 181.2s
[2025-05-11 14:03:21,966][__main__][INFO] - Epoch 19: Evaluating metrics on validation set...
[2025-05-11 14:04:43,479][__main__][INFO] - Epoch 19: Val Metrics | PESQ: 2.235 | STOI: nan | SI-SDR: nan | Eval Time: 81.5s
[2025-05-11 14:04:43,479][__main__][INFO] - Epoch 19/50 | LR: 6.59e-03 | Tr Loss: 0.0061 | Vl Loss(p): 0.0063 | Time: 181.7s
[2025-05-11 14:06:23,544][__main__][INFO] - Epoch 20: Evaluating metrics on validation set...
[2025-05-11 14:07:45,787][__main__][INFO] - Epoch 20: Val Metrics | PESQ: 2.272 | STOI: nan | SI-SDR: nan | Eval Time: 82.2s
[2025-05-11 14:07:45,788][__main__][INFO] - Epoch 20/50 | LR: 5.76e-03 | Tr Loss: 0.0061 | Vl Loss(p): 0.0062 | Time: 182.3s
[2025-05-11 14:07:45,805][__main__][INFO] - Metric val_loss improved (0.0062 --> 0.0062). Saved best model.
[2025-05-11 14:09:25,840][__main__][INFO] - Epoch 21: Evaluating metrics on validation set...
[2025-05-11 14:10:47,392][__main__][INFO] - Epoch 21: Val Metrics | PESQ: 2.266 | STOI: nan | SI-SDR: nan | Eval Time: 81.6s
[2025-05-11 14:10:47,393][__main__][INFO] - Epoch 21/50 | LR: 5.03e-03 | Tr Loss: 0.0061 | Vl Loss(p): 0.0061 | Time: 181.6s
[2025-05-11 14:10:47,410][__main__][INFO] - Metric val_loss improved (0.0061 --> 0.0061). Saved best model.
[2025-05-11 14:12:26,812][__main__][INFO] - Epoch 22: Evaluating metrics on validation set...
[2025-05-11 14:13:34,293][__main__][INFO] - Epoch 22: Val Metrics | PESQ: 2.281 | STOI: nan | SI-SDR: nan | Eval Time: 67.5s
[2025-05-11 14:13:34,293][__main__][INFO] - Epoch 22/50 | LR: 4.39e-03 | Tr Loss: 0.0061 | Vl Loss(p): 0.0061 | Time: 166.9s
[2025-05-11 14:15:12,877][__main__][INFO] - Epoch 23: Evaluating metrics on validation set...
[2025-05-11 14:16:20,679][__main__][INFO] - Epoch 23: Val Metrics | PESQ: 2.275 | STOI: nan | SI-SDR: nan | Eval Time: 67.8s
[2025-05-11 14:16:20,682][__main__][INFO] - Epoch 23/50 | LR: 3.84e-03 | Tr Loss: 0.0061 | Vl Loss(p): 0.0062 | Time: 166.4s
[2025-05-11 14:18:00,569][__main__][INFO] - Epoch 24: Evaluating metrics on validation set...
[2025-05-11 14:19:17,867][__main__][INFO] - Epoch 24: Val Metrics | PESQ: 2.277 | STOI: nan | SI-SDR: nan | Eval Time: 77.3s
[2025-05-11 14:19:17,868][__main__][INFO] - Epoch 24/50 | LR: 3.35e-03 | Tr Loss: 0.0061 | Vl Loss(p): 0.0062 | Time: 177.2s
[2025-05-11 14:20:56,633][__main__][INFO] - Epoch 25: Evaluating metrics on validation set...
[2025-05-11 14:22:04,126][__main__][INFO] - Epoch 25: Val Metrics | PESQ: 2.303 | STOI: nan | SI-SDR: nan | Eval Time: 67.5s
[2025-05-11 14:22:04,127][__main__][INFO] - Epoch 25/50 | LR: 2.93e-03 | Tr Loss: 0.0061 | Vl Loss(p): 0.0061 | Time: 166.3s
[2025-05-11 14:23:43,095][__main__][INFO] - Epoch 26: Evaluating metrics on validation set...
[2025-05-11 14:24:50,017][__main__][INFO] - Epoch 26: Val Metrics | PESQ: 2.285 | STOI: nan | SI-SDR: nan | Eval Time: 66.9s
[2025-05-11 14:24:50,018][__main__][INFO] - Epoch 26/50 | LR: 2.56e-03 | Tr Loss: 0.0061 | Vl Loss(p): 0.0061 | Time: 165.9s
[2025-05-11 14:24:50,050][__main__][INFO] - Metric val_loss improved (0.0061 --> 0.0061). Saved best model.
[2025-05-11 14:26:29,143][__main__][INFO] - Epoch 27: Evaluating metrics on validation set...
[2025-05-11 14:27:36,348][__main__][INFO] - Epoch 27: Val Metrics | PESQ: 2.278 | STOI: nan | SI-SDR: nan | Eval Time: 67.2s
[2025-05-11 14:27:36,348][__main__][INFO] - Epoch 27/50 | LR: 2.24e-03 | Tr Loss: 0.0061 | Vl Loss(p): 0.0061 | Time: 166.3s
[2025-05-11 14:29:15,237][__main__][INFO] - Epoch 28: Evaluating metrics on validation set...
[2025-05-11 14:30:22,388][__main__][INFO] - Epoch 28: Val Metrics | PESQ: 2.275 | STOI: nan | SI-SDR: nan | Eval Time: 67.2s
[2025-05-11 14:30:22,388][__main__][INFO] - Epoch 28/50 | LR: 1.95e-03 | Tr Loss: 0.0061 | Vl Loss(p): 0.0061 | Time: 166.0s
[2025-05-11 14:32:01,219][__main__][INFO] - Epoch 29: Evaluating metrics on validation set...
[2025-05-11 14:33:08,218][__main__][INFO] - Epoch 29: Val Metrics | PESQ: 2.255 | STOI: nan | SI-SDR: nan | Eval Time: 67.0s
[2025-05-11 14:33:08,218][__main__][INFO] - Epoch 29/50 | LR: 1.71e-03 | Tr Loss: 0.0061 | Vl Loss(p): 0.0061 | Time: 165.8s
[2025-05-11 14:34:47,130][__main__][INFO] - Epoch 30: Evaluating metrics on validation set...
[2025-05-11 14:35:54,108][__main__][INFO] - Epoch 30: Val Metrics | PESQ: 2.279 | STOI: nan | SI-SDR: nan | Eval Time: 67.0s
[2025-05-11 14:35:54,108][__main__][INFO] - Epoch 30/50 | LR: 1.49e-03 | Tr Loss: 0.0061 | Vl Loss(p): 0.0061 | Time: 165.9s
[2025-05-11 14:37:33,216][__main__][INFO] - Epoch 31: Evaluating metrics on validation set...
[2025-05-11 14:38:41,978][__main__][INFO] - Epoch 31: Val Metrics | PESQ: 2.283 | STOI: nan | SI-SDR: nan | Eval Time: 68.8s
[2025-05-11 14:38:41,978][__main__][INFO] - Epoch 31/50 | LR: 1.30e-03 | Tr Loss: 0.0061 | Vl Loss(p): 0.0061 | Time: 167.9s
[2025-05-11 14:38:41,980][__main__][INFO] - --- Early stopping triggered at epoch 31 ---
[2025-05-11 14:38:41,980][__main__][INFO] - ==============================
[2025-05-11 14:38:41,980][__main__][INFO] - Training finished.
[2025-05-11 14:38:41,980][__main__][INFO] - Stopped early at epoch 31. Best val_loss: 0.0061 achieved at epoch 26.
[2025-05-11 14:38:41,982][__main__][INFO] - Best model weights saved to: /scratch/lustre/home/maba8006/Tiny-SDnCNN/outputs/2025-05-11_13-09-45/best_model.pt
[2025-05-11 14:38:41,983][__main__][INFO] - ==============================
